---
title: "Linear Regression Modle on Individuals Self rating About Feelings Of Their Life"
author: "Wenxi Li, Tianyi Jiang, Jiatong Li"
date: "Oct.18,2020"
output:
  html_document:
    df_print: paged
---
Github link to all the data and code:

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(tidyverse)
library(survey)
```
## Abstract

An Individual's well-being and living conditions have always been a major topic for the government.
General Social Survey(GSS) is a survey carried out since 1985. It has a great collection of cross-sectional data that allows for many analyses about the living condition of Canadians. In this study, we used data from the 2017 GSS data and aimed to study the Canadian's overall well-being. By building a linear model, we found a linear trend between one's self feelings rate about their life and many explanatory variables, ie. family income, age, etc. From the model, we can predict one's well-being, which could be useful in many ways.


## Introduction
In the GSS 2017, a question 'On a level from 1 to 10, in general, would you say your mental health is...?' was asked. We want to find what factors in the data determine the rating. To do so, we tried to find a model that predicts it. Obviously, the score could be affected by many factors, so in this study, we chose three that we are most interested in, which are one's household size, age, and income of the family. Clearly, an individual's family condition as well as their personal living condition play an important role in determining their own feelings about life. Therefore, we chose the household size and the income of the family as the criteria to measure an individual's family condition, and his/her age as the standard to measure the personal living conditions.

## Data

We carried out the study using the GSS 2017 (General Social Study) data available from CHASS (a computing facility within the Faculty of Arts & Science, University of Toronto). The data itself is published by Statistics Canada. The survey that is used to collect the data practiced a stratification sampling technique; there are a total of 10 strata, where each province of Canada counts as one. The survey estimates are weighted according to the population size of each province(strata).

The GSS 2017 has a target population of all persons who are 15 years old or older in Canada excluding residents of the Yukon, Northwest Territories, and Nunavut and full-time residents of institutions. The survey frame are a list of telephone numbers in use available to Statistics Canada and the Address Register(AR). The final survey sample is those who respond to the telephone call. Noticed that if the phone is not being picked up or the person wasn't available at that time, several more phone calls were made to that telephone number to maximize the respondent's response rate( maximize the survey sample). It is also worth noticing that for the phone numbers that didn't respond, a three-stage adjustment was made; it is adjusted by how much auxiliary information was available to the Statistics Canada or how much auxiliary information were collected from a partial non-response. All the auxiliary information is used to model propensity to respond.


The data are great to perform a regression model since it has a great number of data sets which analyzes a model more convincing and practical. Besides, with each data set, there are also many variables that we can look into and analyze, i.e the person's marital status, number of children, age, etc. We also noticed that the telephone number belonging to the same address were grouped together, which would make the model even more accurate since no duplicate or similar data were obtained. 

However, there do have some drawbacks. For instance, there is missing information that could influence the final model; since we are omitting the data with missing information. Additionally, all the data collected are from those who respond to the telephone interview, but those households or individuals who did not have a phone number were clearly excluded from the survey. Therefore, the final model we built might be biased, since we are not considering the living conditions or well-being of those people.

When deciding what variables needed to be included in our model, we chose the variables that have a representative meaning of an individual's personal and family life. Here we chose the age of the individual, household size, and family income as the three explanatory variables that might be able to explain their rating of the life feelings. Notice here, we chose household size rather than the number of children since the latter is less meaningful than the first; household size has a more general meaning since the number of children is included in it. Additionally, family income is more preferable than an individual's income as it better represents the family conditions of that individual. We also included age since it is the most noticeable variable or factor of respondents themselves. 


```{r,include=FALSE}
data<-read_csv("gss.csv")
filtered<-data%>%select(caseid, feelings_life, age, hh_size, income_family)
filtered<-na.omit(filtered)
filtered$income_family<-factor(filtered$income_family, ordered = FALSE )

```


## Model

```{r,include=FALSE}
N=(1-0.1587)*36540000
n=length(filtered$caseid)
fpc.srs = rep(N, n)
fss.desgin<-svydesign(id=~1, data=filtered, fpc=fpc.srs)
mysvylm <- svyglm(feelings_life ~ age + income_family + hh_size, fss.desgin)


```
We used R software to do the linear regression model. Specifically, we used a finite population correction to make the model more accurate.

From the linear regression model we carried out, we can predict the individual's rate of the feelings of his/her life using their household size, age, and income of the family, where the income of the family is categorical variables. Here, a range of family income is preferred since the number could vary greatly. Therefore, to reduce the number of outliers (unusual or extreme values) and to make the model more accurate, a categorical variable of family income is more ideal. On the other hand, it is reasonable to use age and household size as numerical variables since they are generally easy to be counted or reported, and they are less likely to have too many outliers in them.

The model follows the formula:

rating of one's feelings about their life =  7.5661716 + 0.017026 * age - 0.8310879 * (income_familyLess than $25,000) +  -0.1475670 * (income_family$75,000 to $99,999) - 0.4615397 * (income_family$25,000 to $49,999) - 0.2493725 * (income_family$50,000 to $74,999) 

The model indicates that for every one extra home member, the rating increases by 0.099 on average, the rating increases by 0.0107 on average when individuals are one year older, and the rating decreases less when their family income increases.

Where (income_familyLess than $25,000) = 1 if one's family income is less than $25,000 and 0 otherwise.
(income_family$75,000 to $99,999) = 1 if one's family income is less than $99,999 greater than $75,000 and 0 otherwise.
(income_family$25,000 to $49,999) = 1 if one's family income is less than $99,999 greater than $75,000 and 0 otherwise.
(income_family$50,000 to $79,999) = 1 if one's family income is less than $99,999 greater than $75,000 and 0 otherwise.
If the family income group is $100,000 to $ 124,999 then all the other components of family income = 0.

Here, group $100,000 to $ 124,999 is a base case.

Caveats: this model only describes the pattern found in the 2017GSS data, hence, it may vary from time. The model has several limitations in predicting one's rating about their life feeling. In the model, we are only considering three aspects of the individual, but clearly, there are a great many other factors that determine it. Therefore, a perfect model is not likely to be achieved, instead, we could add more explanatory variables to the model such as marital status, educational background, etc.


## Results


```{r,echo=F,include=T}
ggplot(filtered, aes(x=income_family, y=feelings_life)) + geom_boxplot(fill='yellow')+ coord_flip()+
xlab('income of family') +
  ylab("rate of life feelings") +
  labs('boxplot of life feeling rate grouped byincome family')
```
```{r,include=F}
summary(mysvylm)
```


Variables | Estimates | p-value
------------- | ------------- | --------------|
intercept | 7.5661716 | < 2e-16
age | 0.0107026 | < 2e-16
income_familyLess than $25,000 | -0.8310879 | < 2e-16
income_family$50,000 to $74,999 | -0.2493725 | 1.63e-08
income_family$25,000 to $49,999 | -0.4615397 |  < 2e-16
income_family$75,000 to $99,999 | -0.1475670 | 0.00131
income_family$125,000 and more | -0.2493725 | 1.63e-08
hh_size | 0.0996582 | < 2e-16
adjusted R-Squared value = 0.04468 |

From the box plot above, we see that individuals with higher family income generally have a higher minimum of rating (the left side of the whisker). However, we can clearly see that the rating has to be explained by some other factors since the span of the rating among different income groups are huge, basically all the way from 0 to 10.

We then look at the summary table and see the p-value of each explanatory variable. We see that most of the variables' p-value are less than 0.05, indicating that there's a linear relationship between the rating and these variable. The only exception occurs in the group of family income greater than $125,000, which is quite interesting and will be discussed later. Additionally, the intercept has a value of 7.566 and its p-value is less than 0.05, meaning that we predict one's rating about their life feelings by adding or subtracting from 7.566 given the explanatory variables we know.

Lastly, we calculate the R-squared value to be 0.04468, which is quite small. R-squared value shows the percentage of the variance of the rating explained by the three chosen explanatory variables(age, family income, number of households). The small R-squared value shows that our model doesn't fully predict the expectation of one's rating about their feeling of life.


## Discussion



Here you will discuss conclusions drawn from the results and comment on how it relates to the original goal of the study (which was specified in the Introduction).

# Weaknesses

Here we discuss weaknesses of the study, data, analysis, etc. You can also discuss areas for improvement.

# Next Steps

Here you discuss subsequent work to be done after this report. This can include next steps in terms of statistical analysis (perhaps there is a more efficient algorithm available, or perhaps there is a caveat in the data that would allow for some new technique). Future steps should also be specified in terms of the study setting (eg. including a follow-up survey on something, or a subsequent study that would complement the conclusions of your report).


## References
1. "Age distribution in Canada 2009-2019", Published by H. Plecher, Oct 7, 2020,
 2019https://www.statista.com/statistics/266540/age-distribution-in-canada/ Accesed on 10/18, 2020 
 
2. Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. ISBN 978-3-319-24277-4, https://ggplot2.tidyverse.org.

3. Wickham H, Averick M, Bryan J, Chang W, McGowan LD, François R, Grolemund G, Hayes A, Henry L, Hester J, Kuhn M, Pedersen TL, Miller E, Bache SM, Müller K, Ooms J, Robinson D, Seidel DP, Spinu V, Takahashi K, Vaughan D, Wilke C, Woo K, Yutani H (2019). “Welcome to the tidyverse.” Journal of Open Source Software, 4(43), 1686. doi: 10.21105/joss.01686.


4. Lumley T (2020). “survey: analysis of complex survey samples.” R package version 4.0.
Lumley T (2004). “Analysis of Complex Survey Samples.” Journal of Statistical Software, 9(1), 1-19. R package verson 2.2.
Lumley T (2010). Complex Surveys: A Guide to Analysis Using R: A Guide to Analysis Using R. John Wiley and Sons.


5. RStudio Team (2020). RStudio: Integrated Development for R. RStudio, PBC, Boston, MA URL http://www.rstudio.com/.


6. Guide book of 2017 General Social Survey (GSS): Families Cycle 31 https://sda-artsci-utoronto-ca.myaccess.library.utoronto.ca/sdaweb/dli2/gss/gss31/gss31/more_doc/GSS31_User_Guide.pdf

7. "Canadian general social surveys (GSS)", By Statistics Canada under the terms of the Data Liberation Initiative (DLI), https://sda-artsci-utoronto-ca.myaccess.library.utoronto.ca/cgi-bin/sda/hsda?harcsda4+gss31


